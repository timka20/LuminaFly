# LuminaFly - Система управления дронами-лампами

## Функционал

- **Интерактивная карта** — отображение дронов, столбов и баз на карте Яндекса в реальном времени
- **Real-time обновления** — WebSocket соединение для мгновенных обновлений
- **Автоматическая замена** — система автоматически заменяет перегоревшие лампы
- **Панель управления** — полная статистика и управление дронами


## Стек технологий

**Backend:**
- Node.js + Express
- WebSocket (ws)
- MySQL2
- JWT авторизация

**Frontend:**
- React 18
- Tailwind CSS
- React Router
- Axios
- Recharts

**API:**
- Яндекс.Карты API

## Структура проекта

```
luminafly/
├── server/                 # Backend
│   ├── index.js           # Основной сервер
│   ├── simulation.js      # Симуляция реальных поломок ламп и их фикс
│   ├── init-database.js   # Инициализация БД
│   ├── package.json
│   └── .env               # Переименуйте .env.example в .env
├── client/                # Frontend
│   ├── src/
│   │   ├── pages/        # Страницы
│   │   ├── components/   # Компоненты
│   │   ├── contexts/     # React контексты
│   │   ├── hooks/        # Хуки
│   │   └── utils/        # Утилиты
│   ├── package.json
│   └── index.html
└── README.md
```

# Запуск проекта или просмотр его

## Просмотр проекта

Вы можете зайти на сайт https://luminafly.timka20.ru/ <- там изучить сайт

## Запуск и установка проекта

### 1. Клонирование и установка

```bash
git clone https://github.com/timka20/LuminaFly.git
```

### 2. Настройка базы данных

Чтобы запустить проект, вам нужно установить MySQL базу данных и заполнить поля в .env файле:
- Host: `ваш хост`
- Port: `3306`
- User: `юзера`
- Password: `пароль`
- Database: `luminafly`

### 3. Запуск Backend

```bash
cd server
npm install
node init-database.js    # Инициализация таблиц и данных
npm start                # Запуск сервера на порту 27484
```

### 4. Запуск Frontend

```bash
cd client
npm install
npm run dev              # Запуск на порту 27483
```

### 5. Открытие приложения

- Frontend: http://localhost:27483
- Backend API: http://localhost:27484

## Данные для входа

| Роль | Логин | Пароль |
|------|-------|--------|
| Администратор | admin | admin123 |


# Краткое описание работы в режиме симуляции:

1. **Мониторинг** — система постоянно следит за состоянием ламп
2. **Обнаружение** — при перегорании лампы создаётся задача на замену
3. **Замена** — свободный дрон вылетает с ближайшей базы
4. **Обмен** — старый дрон отстыковывается, новый пристыковывается
5. **Возврат** — старый дрон летит на базу для ремонта (5 секунд)
6. **Готовность** — отремонтированный дрон снова доступен


## WebSocket события

- `drone_position` — обновление позиции дрона
- `lamp_burned_out` — лампа перегорела
- `lamp_replaced` — лампа заменена
- `drone_repaired` — дрон отремонтирован

## API Endpoints

### Авторизация
- `POST /api/auth/login` — вход

### Данные
- `GET /api/drones` — список дронов
- `GET /api/poles` — список столбов
- `GET /api/bases` — список баз
- `GET /api/statistics` — статистика
- `GET /api/drones/:id/details` — детали дрона


